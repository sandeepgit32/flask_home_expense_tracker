<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:100,300,400,600" rel="stylesheet" type="text/css">
    <link href="http://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css" rel="stylesheet" type="text/css">
    <link type="text/css" href="{{ url_for('static', filename='budget_style.css') }}" rel="stylesheet">
    <title>Home Budget</title>
</head>

<body>

    <div class="top">
        <a class="logout__text" href="{{ url_for('logout') }}">Logout</a>
        <div class="user__text">Welcome to <b>{{ user }}</b>'s Expense Sheet</div>
        {% with messages = get_flashed_messages() %}
            {% if messages %}
                <div class=flashes>
                    {% for message in messages %}
                        <div>{{ message }}</div>
                    {% endfor %}
                </div>
            {% endif %}
        {% endwith %}
        <div class="budget">
            <div class="budget__title">
                Available Budget in <span class="budget__title--month">{{ display_month_year }}</span>
            </div>

            <div class="budget__value">{{ available_budget }}</div>

            <div class="budget__income clearfix">
                <div class="budget__income--text">Income</div>
                <div class="right">
                    <div class="budget__income--value">+ {{ total_budget }}</div>
                    <div class="budget__income--percentage">&nbsp;</div>
                </div>
            </div>

            <div class="budget__expenses clearfix">
                <div class="budget__expenses--text">Expenses</div>
                <div class="right clearfix">
                    <div class="budget__expenses--value">- {{ total_expense }}</div>
                    <div class="budget__expenses--percentage">{{ overall_percentage }}%</div>
                </div>
            </div>
        </div>
    </div>

    <div class="bottom">
        <div class="add">
            <div class="add__container">
                <form name="addForm" id="addForm" method="POST" action="{{ url_for('add') }}" novalidate>
                    <input class="add__date" name="date" type="date"/>
                    <select class="add__type" name="transaction_type">
                        <option value="positive">+</option>
                        <option value="negative" selected>-</option>
                    </select>
                    <input type="text" class="add__description" placeholder="Add description" name="description">
                    <input type="number" class="add__value" placeholder="Value" name="value">
                    <button type="submit" class="add__btn"><i class="ion-ios-checkmark-outline"></i></button>
                </form>
            </div>
        </div>

        <div class="container clearfix">
            <div class="income">
                <h2 class="icome__title">Income</h2>

                <div class="income__list">
                    {% for transaction in positive_transactions %}
                        <div class="item clearfix" id="income-0">
                            <div class="item__date"><b>{{ transaction.transaction_day }}/{{ transaction.transaction_month }}/{{ transaction.transaction_year }}</b></div>
                            <div class="item__description">{{ transaction.description }}</div>
                            <div class="right clearfix">
                                <div class="item__value">+ {{ transaction.value }}</div>
                                <div class="item__delete">
                                    <form name="deleteForm" id="deleteForm" method="POST" action="{{ url_for('delete') }}" novalidate>
                                        <input type="hidden" name="transaction_id" value="{{ transaction.id }}">
                                        <button class="item__delete--btn"><i class="ion-ios-close-outline"></i></button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    {% endfor %}

                </div>
            </div>


            <div class="expenses">
                <h2 class="expenses__title">Expenses</h2>

                <div class="expenses__list">

                    {% for transaction, percentage in negative_transactions_percentages %}
                        <div class="item clearfix" id="expense-0">
                            <div class="item__date"><b>{{ transaction.transaction_day }}/{{ transaction.transaction_month }}/{{ transaction.transaction_year }}</b></div>
                            <div class="item__description">{{ transaction.description }}</div>
                            <div class="right clearfix">
                                <div class="item__value">- {{ transaction.value }}</div>
                                <div class="item__percentage">{{ percentage }}%</div>
                                <div class="item__delete">
                                    <form name="deleteForm" id="deleteForm" method="POST" action="{{ url_for('delete') }}" novalidate>
                                        <input type="hidden" name="transaction_id" value="{{ transaction.id }}">
                                        <button type="submit" class="item__delete--btn"><i class="ion-ios-close-outline"></i></button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                        
                </div>
            </div>
        </div>


    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script>
        $(document).ready(function() {
            var date = new Date();

            var day = date.getDate();
            var month = date.getMonth() + 1;
            var year = date.getFullYear();

            if (month < 10) month = "0" + month;
            if (day < 10) day = "0" + day;

            var today = year + "-" + month + "-" + day;       
            $(".add__date").attr("value", today);
        });
    </script>

    <!-- <script src="{{ url_for('static', filename='budget.js') }}"></script> -->
</body>

</html>